+-------+------------------------------------+------------------------------------+----------+--------------------------------------------------------------------------------------------------------------+
| type  |                name                |              tbl_name              | rootpage |                                                     sql                                                      |
+-------+------------------------------------+------------------------------------+----------+--------------------------------------------------------------------------------------------------------------+
| table | schema                             | schema                             | 2        | CREATE TABLE schema (                                                                                        |
|       |                                    |                                    |          |     id         INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                   |
|       |                                    |                                    |          |     version    INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     updated_at DATETIME NOT NULL,                                                                            |
|       |                                    |                                    |          |     UNIQUE (version)                                                                                         |
|       |                                    |                                    |          | )                                                                                                            |
| table | certificates                       | certificates                       | 5        | CREATE TABLE certificates (                                                                                  |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     fingerprint TEXT NOT NULL,                                                                               |
|       |                                    |                                    |          |     type INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     certificate TEXT NOT NULL,                                                                               |
|       |                                    |                                    |          |     UNIQUE (fingerprint)                                                                                     |
|       |                                    |                                    |          | )                                                                                                            |
| table | config                             | config                             | 7        | CREATE TABLE config (                                                                                        |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (key)                                                                                             |
|       |                                    |                                    |          | )                                                                                                            |
| table | images                             | images                             | 9        | CREATE TABLE "images" (                                                                                      |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     fingerprint TEXT NOT NULL,                                                                               |
|       |                                    |                                    |          |     filename TEXT NOT NULL,                                                                                  |
|       |                                    |                                    |          |     size INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     public INTEGER NOT NULL DEFAULT 0,                                                                       |
|       |                                    |                                    |          |     architecture INTEGER NOT NULL,                                                                           |
|       |                                    |                                    |          |     creation_date DATETIME,                                                                                  |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     upload_date DATETIME NOT NULL,                                                                           |
|       |                                    |                                    |          |     cached INTEGER NOT NULL DEFAULT 0,                                                                       |
|       |                                    |                                    |          |     last_use_date DATETIME,                                                                                  |
|       |                                    |                                    |          |     auto_update INTEGER NOT NULL DEFAULT 0,                                                                  |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     type INTEGER NOT NULL DEFAULT 0,                                                                         |
|       |                                    |                                    |          |     UNIQUE (project_id, fingerprint),                                                                        |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | images_aliases                     | images_aliases                     | 11       | CREATE TABLE "images_aliases" (                                                                              |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     image_id INTEGER NOT NULL,                                                                               |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     UNIQUE (project_id, name),                                                                               |
|       |                                    |                                    |          |     FOREIGN KEY (image_id) REFERENCES images (id) ON DELETE CASCADE,                                         |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | images_nodes                       | images_nodes                       | 14       | CREATE TABLE images_nodes (                                                                                  |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     image_id INTEGER NOT NULL,                                                                               |
|       |                                    |                                    |          |     node_id INTEGER NOT NULL,                                                                                |
|       |                                    |                                    |          |     UNIQUE (image_id, node_id),                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (image_id) REFERENCES images (id) ON DELETE CASCADE,                                         |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | images_profiles                    | images_profiles                    | 16       | CREATE TABLE images_profiles (                                                                               |
|       |                                    |                                    |          | 	image_id INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          | 	profile_id INTEGER NOT NULL,                                                                                 |
|       |                                    |                                    |          | 	FOREIGN KEY (image_id) REFERENCES images (id) ON DELETE CASCADE,                                             |
|       |                                    |                                    |          | 	FOREIGN KEY (profile_id) REFERENCES profiles (id) ON DELETE CASCADE,                                         |
|       |                                    |                                    |          | 	UNIQUE (image_id, profile_id)                                                                                |
|       |                                    |                                    |          | )                                                                                                            |
| table | images_properties                  | images_properties                  | 19       | CREATE TABLE images_properties (                                                                             |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     image_id INTEGER NOT NULL,                                                                               |
|       |                                    |                                    |          |     type INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (image_id) REFERENCES images (id) ON DELETE CASCADE                                          |
|       |                                    |                                    |          | )                                                                                                            |
| table | images_source                      | images_source                      | 20       | CREATE TABLE images_source (                                                                                 |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     image_id INTEGER NOT NULL,                                                                               |
|       |                                    |                                    |          |     server TEXT NOT NULL,                                                                                    |
|       |                                    |                                    |          |     protocol INTEGER NOT NULL,                                                                               |
|       |                                    |                                    |          |     certificate TEXT NOT NULL,                                                                               |
|       |                                    |                                    |          |     alias TEXT NOT NULL,                                                                                     |
|       |                                    |                                    |          |     FOREIGN KEY (image_id) REFERENCES images (id) ON DELETE CASCADE                                          |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances                          | instances                          | 21       | CREATE TABLE "instances" (                                                                                   |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     node_id INTEGER NOT NULL,                                                                                |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     architecture INTEGER NOT NULL,                                                                           |
|       |                                    |                                    |          |     type INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     ephemeral INTEGER NOT NULL DEFAULT 0,                                                                    |
|       |                                    |                                    |          |     creation_date DATETIME NOT NULL DEFAULT 0,                                                               |
|       |                                    |                                    |          |     stateful INTEGER NOT NULL DEFAULT 0,                                                                     |
|       |                                    |                                    |          |     last_use_date DATETIME,                                                                                  |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     UNIQUE (project_id, name),                                                                               |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE,                                           |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_backups                  | instances_backups                  | 25       | CREATE TABLE "instances_backups" (                                                                           |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_id INTEGER NOT NULL,                                                                            |
|       |                                    |                                    |          |     name VARCHAR(255) NOT NULL,                                                                              |
|       |                                    |                                    |          |     creation_date DATETIME,                                                                                  |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     container_only INTEGER NOT NULL default 0,                                                               |
|       |                                    |                                    |          |     optimized_storage INTEGER NOT NULL default 0,                                                            |
|       |                                    |                                    |          |     FOREIGN KEY (instance_id) REFERENCES "instances" (id) ON DELETE CASCADE,                                 |
|       |                                    |                                    |          |     UNIQUE (instance_id, name)                                                                               |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_config                   | instances_config                   | 27       | CREATE TABLE "instances_config" (                                                                            |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_id INTEGER NOT NULL,                                                                            |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (instance_id) REFERENCES "instances" (id) ON DELETE CASCADE,                                 |
|       |                                    |                                    |          |     UNIQUE (instance_id, key)                                                                                |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_devices                  | instances_devices                  | 29       | CREATE TABLE "instances_devices" (                                                                           |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_id INTEGER NOT NULL,                                                                            |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     type INTEGER NOT NULL default 0,                                                                         |
|       |                                    |                                    |          |     FOREIGN KEY (instance_id) REFERENCES "instances" (id) ON DELETE CASCADE,                                 |
|       |                                    |                                    |          |     UNIQUE (instance_id, name)                                                                               |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_devices_config           | instances_devices_config           | 31       | CREATE TABLE "instances_devices_config" (                                                                    |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_device_id INTEGER NOT NULL,                                                                     |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (instance_device_id) REFERENCES "instances_devices" (id) ON DELETE CASCADE,                  |
|       |                                    |                                    |          |     UNIQUE (instance_device_id, key)                                                                         |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_profiles                 | instances_profiles                 | 34       | CREATE TABLE "instances_profiles" (                                                                          |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_id INTEGER NOT NULL,                                                                            |
|       |                                    |                                    |          |     profile_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     apply_order INTEGER NOT NULL default 0,                                                                  |
|       |                                    |                                    |          |     UNIQUE (instance_id, profile_id),                                                                        |
|       |                                    |                                    |          |     FOREIGN KEY (instance_id) REFERENCES "instances"(id) ON DELETE CASCADE,                                  |
|       |                                    |                                    |          |     FOREIGN KEY (profile_id) REFERENCES profiles(id) ON DELETE CASCADE                                       |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_snapshots                | instances_snapshots                | 41       | CREATE TABLE instances_snapshots (                                                                           |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_id INTEGER NOT NULL,                                                                            |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     creation_date DATETIME NOT NULL DEFAULT 0,                                                               |
|       |                                    |                                    |          |     stateful INTEGER NOT NULL DEFAULT 0,                                                                     |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     UNIQUE (instance_id, name),                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (instance_id) REFERENCES instances (id) ON DELETE CASCADE                                    |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_snapshots_config         | instances_snapshots_config         | 43       | CREATE TABLE instances_snapshots_config (                                                                    |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_snapshot_id INTEGER NOT NULL,                                                                   |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (instance_snapshot_id) REFERENCES instances_snapshots (id) ON DELETE CASCADE,                |
|       |                                    |                                    |          |     UNIQUE (instance_snapshot_id, key)                                                                       |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_snapshots_devices        | instances_snapshots_devices        | 45       | CREATE TABLE instances_snapshots_devices (                                                                   |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_snapshot_id INTEGER NOT NULL,                                                                   |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     type INTEGER NOT NULL default 0,                                                                         |
|       |                                    |                                    |          |     FOREIGN KEY (instance_snapshot_id) REFERENCES instances_snapshots (id) ON DELETE CASCADE,                |
|       |                                    |                                    |          |     UNIQUE (instance_snapshot_id, name)                                                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | instances_snapshots_devices_config | instances_snapshots_devices_config | 47       | CREATE TABLE instances_snapshots_devices_config (                                                            |
|       |                                    |                                    |          |     id INTEGER primary key AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     instance_snapshot_device_id INTEGER NOT NULL,                                                            |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (instance_snapshot_device_id) REFERENCES instances_snapshots_devices (id) ON DELETE CASCADE, |
|       |                                    |                                    |          |     UNIQUE (instance_snapshot_device_id, key)                                                                |
|       |                                    |                                    |          | )                                                                                                            |
| table | networks                           | networks                           | 50       | CREATE TABLE "networks" (                                                                                    |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     state INTEGER NOT NULL DEFAULT 0,                                                                        |
|       |                                    |                                    |          |     type INTEGER NOT NULL DEFAULT 0,                                                                         |
|       |                                    |                                    |          |     UNIQUE (project_id, name)                                                                                |
|       |                                    |                                    |          | )                                                                                                            |
| table | networks_config                    | networks_config                    | 52       | CREATE TABLE "networks_config" (                                                                             |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     network_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     node_id INTEGER,                                                                                         |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (network_id, node_id, key),                                                                       |
|       |                                    |                                    |          |     FOREIGN KEY (network_id) REFERENCES "networks" (id) ON DELETE CASCADE,                                   |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | networks_nodes                     | networks_nodes                     | 54       | CREATE TABLE "networks_nodes" (                                                                              |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     network_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     node_id INTEGER NOT NULL,                                                                                |
|       |                                    |                                    |          |     UNIQUE (network_id, node_id),                                                                            |
|       |                                    |                                    |          |     FOREIGN KEY (network_id) REFERENCES "networks" (id) ON DELETE CASCADE,                                   |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | nodes                              | nodes                              | 56       | CREATE TABLE nodes (                                                                                         |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY,                                                                                  |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     description TEXT DEFAULT '',                                                                             |
|       |                                    |                                    |          |     address TEXT NOT NULL,                                                                                   |
|       |                                    |                                    |          |     schema INTEGER NOT NULL,                                                                                 |
|       |                                    |                                    |          |     api_extensions INTEGER NOT NULL,                                                                         |
|       |                                    |                                    |          |     heartbeat DATETIME DEFAULT CURRENT_TIMESTAMP,                                                            |
|       |                                    |                                    |          |     pending INTEGER NOT NULL DEFAULT 0,                                                                      |
|       |                                    |                                    |          |     arch INTEGER NOT NULL DEFAULT 0 CHECK (arch > 0),                                                        |
|       |                                    |                                    |          |     failure_domain_id INTEGER DEFAULT NULL REFERENCES nodes_failure_domains (id) ON DELETE SET NULL,         |
|       |                                    |                                    |          |     UNIQUE (name),                                                                                           |
|       |                                    |                                    |          |     UNIQUE (address)                                                                                         |
|       |                                    |                                    |          | )                                                                                                            |
| table | nodes_failure_domains              | nodes_failure_domains              | 59       | CREATE TABLE nodes_failure_domains (                                                                         |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     UNIQUE (name)                                                                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | nodes_roles                        | nodes_roles                        | 61       | CREATE TABLE nodes_roles (                                                                                   |
|       |                                    |                                    |          |     node_id INTEGER NOT NULL,                                                                                |
|       |                                    |                                    |          |     role INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE,                                           |
|       |                                    |                                    |          |     UNIQUE (node_id, role)                                                                                   |
|       |                                    |                                    |          | )                                                                                                            |
| table | operations                         | operations                         | 63       | CREATE TABLE "operations" (                                                                                  |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     uuid TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     node_id TEXT NOT NULL,                                                                                   |
|       |                                    |                                    |          |     type INTEGER NOT NULL DEFAULT 0,                                                                         |
|       |                                    |                                    |          |     project_id INTEGER,                                                                                      |
|       |                                    |                                    |          |     UNIQUE (uuid),                                                                                           |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE,                                           |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | profiles                           | profiles                           | 66       | CREATE TABLE "profiles" (                                                                                    |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     UNIQUE (project_id, name),                                                                               |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | profiles_config                    | profiles_config                    | 68       | CREATE TABLE profiles_config (                                                                               |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     profile_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (profile_id, key),                                                                                |
|       |                                    |                                    |          |     FOREIGN KEY (profile_id) REFERENCES profiles(id) ON DELETE CASCADE                                       |
|       |                                    |                                    |          | )                                                                                                            |
| table | profiles_devices                   | profiles_devices                   | 70       | CREATE TABLE profiles_devices (                                                                              |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     profile_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     type INTEGER NOT NULL default 0,                                                                         |
|       |                                    |                                    |          |     UNIQUE (profile_id, name),                                                                               |
|       |                                    |                                    |          |     FOREIGN KEY (profile_id) REFERENCES profiles (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | profiles_devices_config            | profiles_devices_config            | 72       | CREATE TABLE profiles_devices_config (                                                                       |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     profile_device_id INTEGER NOT NULL,                                                                      |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (profile_device_id, key),                                                                         |
|       |                                    |                                    |          |     FOREIGN KEY (profile_device_id) REFERENCES profiles_devices (id) ON DELETE CASCADE                       |
|       |                                    |                                    |          | )                                                                                                            |
| table | projects                           | projects                           | 75       | CREATE TABLE projects (                                                                                      |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     UNIQUE (name)                                                                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | projects_config                    | projects_config                    | 77       | CREATE TABLE projects_config (                                                                               |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE,                                     |
|       |                                    |                                    |          |     UNIQUE (project_id, key)                                                                                 |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_pools                      | storage_pools                      | 80       | CREATE TABLE storage_pools (                                                                                 |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     driver TEXT NOT NULL,                                                                                    |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     state INTEGER NOT NULL DEFAULT 0,                                                                        |
|       |                                    |                                    |          |     UNIQUE (name)                                                                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_pools_config               | storage_pools_config               | 82       | CREATE TABLE storage_pools_config (                                                                          |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     storage_pool_id INTEGER NOT NULL,                                                                        |
|       |                                    |                                    |          |     node_id INTEGER,                                                                                         |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (storage_pool_id, node_id, key),                                                                  |
|       |                                    |                                    |          |     FOREIGN KEY (storage_pool_id) REFERENCES storage_pools (id) ON DELETE CASCADE,                           |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_pools_nodes                | storage_pools_nodes                | 84       | CREATE TABLE storage_pools_nodes (                                                                           |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     storage_pool_id INTEGER NOT NULL,                                                                        |
|       |                                    |                                    |          |     node_id INTEGER NOT NULL,                                                                                |
|       |                                    |                                    |          |     UNIQUE (storage_pool_id, node_id),                                                                       |
|       |                                    |                                    |          |     FOREIGN KEY (storage_pool_id) REFERENCES storage_pools (id) ON DELETE CASCADE,                           |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE                                            |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_volumes                    | storage_volumes                    | 86       | CREATE TABLE "storage_volumes" (                                                                             |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     storage_pool_id INTEGER NOT NULL,                                                                        |
|       |                                    |                                    |          |     node_id INTEGER,                                                                                         |
|       |                                    |                                    |          |     type INTEGER NOT NULL,                                                                                   |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     project_id INTEGER NOT NULL,                                                                             |
|       |                                    |                                    |          |     content_type INTEGER NOT NULL DEFAULT 0,                                                                 |
|       |                                    |                                    |          |     UNIQUE (storage_pool_id, node_id, project_id, name, type),                                               |
|       |                                    |                                    |          |     FOREIGN KEY (storage_pool_id) REFERENCES storage_pools (id) ON DELETE CASCADE,                           |
|       |                                    |                                    |          |     FOREIGN KEY (node_id) REFERENCES nodes (id) ON DELETE CASCADE,                                           |
|       |                                    |                                    |          |     FOREIGN KEY (project_id) REFERENCES projects (id) ON DELETE CASCADE                                      |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_volumes_backups            | storage_volumes_backups            | 89       | CREATE TABLE storage_volumes_backups (                                                                       |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     storage_volume_id INTEGER NOT NULL,                                                                      |
|       |                                    |                                    |          |     name VARCHAR(255) NOT NULL,                                                                              |
|       |                                    |                                    |          |     creation_date DATETIME,                                                                                  |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     volume_only INTEGER NOT NULL default 0,                                                                  |
|       |                                    |                                    |          |     optimized_storage INTEGER NOT NULL default 0,                                                            |
|       |                                    |                                    |          |     FOREIGN KEY (storage_volume_id) REFERENCES "storage_volumes" (id) ON DELETE CASCADE,                     |
|       |                                    |                                    |          |     UNIQUE (storage_volume_id, name)                                                                         |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_volumes_config             | storage_volumes_config             | 91       | CREATE TABLE storage_volumes_config (                                                                        |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     storage_volume_id INTEGER NOT NULL,                                                                      |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     UNIQUE (storage_volume_id, key),                                                                         |
|       |                                    |                                    |          |     FOREIGN KEY (storage_volume_id) REFERENCES storage_volumes (id) ON DELETE CASCADE                        |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_volumes_snapshots          | storage_volumes_snapshots          | 93       | CREATE TABLE storage_volumes_snapshots (                                                                     |
|       |                                    |                                    |          |     id INTEGER NOT NULL,                                                                                     |
|       |                                    |                                    |          |     storage_volume_id INTEGER NOT NULL,                                                                      |
|       |                                    |                                    |          |     name TEXT NOT NULL,                                                                                      |
|       |                                    |                                    |          |     description TEXT,                                                                                        |
|       |                                    |                                    |          |     expiry_date DATETIME,                                                                                    |
|       |                                    |                                    |          |     UNIQUE (id),                                                                                             |
|       |                                    |                                    |          |     UNIQUE (storage_volume_id, name),                                                                        |
|       |                                    |                                    |          |     FOREIGN KEY (storage_volume_id) REFERENCES storage_volumes (id) ON DELETE CASCADE                        |
|       |                                    |                                    |          | )                                                                                                            |
| table | storage_volumes_snapshots_config   | storage_volumes_snapshots_config   | 96       | CREATE TABLE storage_volumes_snapshots_config (                                                              |
|       |                                    |                                    |          |     id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,                                                           |
|       |                                    |                                    |          |     storage_volume_snapshot_id INTEGER NOT NULL,                                                             |
|       |                                    |                                    |          |     key TEXT NOT NULL,                                                                                       |
|       |                                    |                                    |          |     value TEXT,                                                                                              |
|       |                                    |                                    |          |     FOREIGN KEY (storage_volume_snapshot_id) REFERENCES storage_volumes_snapshots (id) ON DELETE CASCADE,    |
|       |                                    |                                    |          |     UNIQUE (storage_volume_snapshot_id, key)                                                                 |
|       |                                    |                                    |          | )                                                                                                            |
+-------+------------------------------------+------------------------------------+----------+--------------------------------------------------------------------------------------------------------------+
